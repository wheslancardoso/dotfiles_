import{a as gt}from"../../chunks/CRCU3Y7V.js";import{a as vt}from"../../chunks/ZJ7UPJRT.js";import{a as Ft,b as Jt,c as ht,d as xt,e as Ct,f as It,g as St,h as yt,i as Mt,j as Tt,n as bt}from"../../chunks/SAIZ6RKG.js";import"../../chunks/OTE5SEU6.js";import"../../chunks/GCPSMIV2.js";import"../../chunks/WYSBWNIM.js";import"../../chunks/IGNWSMS2.js";import{A as it,D as lt,G as B,H as mt,W as pt,X as D,aa as ut,ba as ct,ra as dt,u as et,y as rt}from"../../chunks/36BQJYSV.js";import{f as ft}from"../../chunks/EF5GRFCD.js";import{O as st}from"../../chunks/I2XYMP7X.js";import"../../chunks/LN7GN6PK.js";import"../../chunks/VV54QQJA.js";import{a as Wt,b as j}from"../../chunks/SCWZBJFE.js";import{c as X}from"../../chunks/WZUFDNVB.js";import{a as R,b as tt}from"../../chunks/5T4V74FX.js";import{a as y,j as at}from"../../chunks/KSWBD2TZ.js";import"../../chunks/RF7QDMRO.js";import{a as nt}from"../../chunks/ABULMT32.js";import{d as z}from"../../chunks/MKFZQTYG.js";import{e as ot}from"../../chunks/4SC7XEKB.js";import{D as Z,a as g,r as w}from"../../chunks/23DIE7BK.js";import"../../chunks/ON4Q5ESC.js";import"../../chunks/REMB6LXX.js";import{V as q,W as N,X as Q,a as W,e as L}from"../../chunks/BK6QTIUI.js";import"../../chunks/VYGUKUEK.js";import{a as V,f as Y,i as $}from"../../chunks/X6PP3PBE.js";import"../../chunks/JS22TWPO.js";import{I as k,e as K}from"../../chunks/BR2YNKDZ.js";import{a as E}from"../../chunks/BIAB2ZEP.js";import{e as C}from"../../chunks/O5NYTI7P.js";var I=C(E());var h=C(E());var F=C(Ft()),Et=C(Jt()),n=C(E());var _="root",Vt=String("production")==="production",Yt=async(s,e)=>{try{let u=[...e];s==="gmailButton"&&(u=e.map(r=>{let a=L.find(i=>i.id===r.id);return a&&a.data.editable===!1?a:r}));let l=await Q(r=>{var a;return{...r,buttonSettings:{...r.buttonSettings,[s]:{...(a=r.buttonSettings)==null?void 0:a[s],contextMenu:u}}}})}catch(u){}},$t=(s,e,u)=>{var a;if(e===u)return!1;if(u===_)return!0;let l=s.find(i=>i.id===u);if(!l||((a=l==null?void 0:l.data)==null?void 0:a.type)!=="group")return!1;let r=s.find(i=>i.id===l.parent);for(;r&&r.parentId!==_;){if(r.id===e)return!1;r=s.find(i=>i.id===r.parentId)}return!0},jt=s=>{let{buttonKey:e,defaultContextMenuJson:u,iconSetting:l=!1}=s,[r,a]=(0,n.useState)(!1),[i,f]=(0,n.useState)(null),[p,x]=(0,n.useState)([]),[M,S]=(0,n.useState)(!1),[T,G]=(0,n.useState)(null),[O,U]=(0,n.useState)(null),zt=async t=>{x(t)},Dt=async()=>{let t=W();f({id:t,parent:_,droppable:!0,text:"",data:{editable:!0,type:"shortcuts",actions:[]}})},_t=async()=>{let t=W();f({id:t,parent:_,droppable:!0,text:"",data:{editable:!0,type:"group",actions:[]}})},Gt=(0,n.useCallback)((t,m,c)=>{t.data.type==="group"?J({...t,text:t.text?t.text:"New group"}):J({...t,text:t.text?t.text:"New option",data:{...t.data,actions:et(e,m,c)}}),f(null)},[e]),J=t=>{x(m=>{let c=!1,b=m.map(v=>v.id===t.id?(c=!0,t):v);return c||b.push(t),b})},Ut=t=>{let m=(c,b)=>c.reduce((v,P)=>P.parent===b?[...v,P.id,...m(c,P.id)]:v,[]);x(c=>{let b=m(p,t).concat([t]);return c.filter(P=>!b.includes(P.id))})},H=(t,m)=>{U(t),m&&G(m),S(!0)},Ht=()=>{S(!1),U(null)},Kt=t=>{if(t==="reset")try{a(!0),x(u||[])}catch(m){}finally{a(!1)}t==="delete"&&T&&Ut(T),S(!1),U(null),f(null)};return(0,n.useEffect)(()=>{let t=!1;return(async()=>{let c=await N(e);t||x(c)})(),()=>{t=!0}},[e]),(0,n.useEffect)(()=>{Yt(e,p)},[p]),n.default.createElement(g,{gap:3},n.default.createElement(X,{elevation:0,sx:{border:"1px solid rgba(0, 0, 0, 0.08)"}},n.default.createElement(y,{height:640,p:2,width:"50%",flexShrink:0,overflow:"auto",position:"relative"},!Vt&&n.default.createElement(g,null,n.default.createElement(Mt,{treeData:p})),n.default.createElement(ht,{backend:xt,options:Ct()},n.default.createElement(It,{tree:p,rootId:"root",onDrop:zt,sort:!1,classes:{placeholder:"context-menu--placeholder"},canDrag:t=>!!(t!=null&&t.droppable),canDrop:(t,{dragSource:m,dropTargetId:c})=>m?$t(t,String(m.id),String(c)):!1,dropTargetOffset:10,placeholderRender:(t,m)=>n.default.createElement(yt,{node:t,depth:m.depth}),insertDroppableFirst:!1,render:(t,m)=>n.default.createElement(St,{isActive:(i==null?void 0:i.id)===t.id,onEdit:f,onDelete:c=>H("delete",c),node:t,params:m})})))),i&&n.default.createElement(bt,{open:!!i,iconSetting:l,settingsKey:e,onSave:Gt,onCancel:()=>f(null),onDelete:t=>H("delete",t),node:i}),n.default.createElement(g,{direction:"row",alignItems:"center",mb:2,spacing:2},n.default.createElement(z,{disableElevation:!0,variant:"contained",onClick:Dt,disabled:r,startIcon:n.default.createElement(F.default,null)},"New option"),n.default.createElement(z,{disableElevation:!0,variant:"contained",onClick:_t,disabled:r,startIcon:n.default.createElement(F.default,null)},"New option group"),n.default.createElement(z,{disableElevation:!0,variant:"outlined",disabled:r,onClick:()=>H("reset"),startIcon:n.default.createElement(Et.default,null)},"Restore defaults")),M&&O&&n.default.createElement(Tt,{open:M,nodeType:i==null?void 0:i.data.type,actionType:O,onClose:Ht,onConfirm:Kt}))},At=jt;var qt=String("MaxAI.me"),Nt=()=>{let[s,e]=h.default.useState("reply");return h.default.createElement(B,{maxWidth:"lg"},h.default.createElement(g,{spacing:4,my:4},h.default.createElement(g,{direction:"row",alignItems:"center",spacing:2},h.default.createElement(R,{sx:{fontSize:32,color:"inherit"}}),h.default.createElement(w,{fontSize:24,fontWeight:700},qt," Settings")),h.default.createElement(ct,{value:s,onChange:(l,r)=>{e(r)}},h.default.createElement(ut,{value:"reply",label:"Edit menu options"})),s==="reply"&&h.default.createElement(At,{iconSetting:!0,defaultContextMenuJson:L,buttonKey:"gmailButton"})))},Pt=Nt;var o=C(E());var d=C(E());var Qt=()=>{var p;let{syncUserInfo:s,userInfo:e,loading:u}=dt(),[l,r]=d.default.useState(null),a=Boolean(l),i=x=>{r(x.currentTarget)},f=()=>{r(null)};return nt(()=>{s()}),d.default.createElement(d.default.Fragment,null,d.default.createElement(y,{sx:{display:"flex",alignItems:"center",textAlign:"center"}},d.default.createElement(at,{title:"Account settings"},d.default.createElement(ot,{onClick:i,size:"small","aria-controls":a?"account-menu":void 0,"aria-haspopup":"true","aria-expanded":a?"true":void 0},!u&&d.default.createElement(lt,{sx:{width:32,height:32,textTransform:"capitalize"}},((p=e==null?void 0:e.email)==null?void 0:p[0])||"M")))),d.default.createElement(pt,{anchorEl:l,id:"account-menu",open:a,onClose:f,onClick:f,PaperProps:{elevation:0,sx:{overflow:"visible",filter:"drop-shadow(0px 2px 8px rgba(0,0,0,0.32))",mt:1.5,"& .MuiAvatar-root":{width:32,height:32,ml:-.5,mr:1},"&:before":{content:'""',display:"block",position:"absolute",top:0,right:14,width:10,height:10,bgcolor:"background.paper",transform:"translateY(-50%) rotate(45deg)",zIndex:0}}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"}},d.default.createElement(D,{disabled:!0},e==null?void 0:e.email),d.default.createElement(D,{component:"a",target:"_blank",href:`${k}/my-plan`,onClick:()=>{f()}},"My account"),d.default.createElement(D,{component:"a",target:"_blank",href:`${k}/logout`,onClick:()=>{f()}},"Log out")))},kt=Qt;var Xt=o.default.lazy(()=>import("../../chunks/P4ZTNF2N.js")),Zt=o.default.lazy(()=>import("../../chunks/W5EOUIAS.js")),Rt=o.default.lazy(()=>import("../../chunks/GK5A2V7P.js")),to=()=>{let{loaded:s,isLogin:e,loading:u}=rt(),[l,r]=(0,o.useState)(""),a=o.default.useRef(!1);(0,o.useEffect)(()=>{if(s){let p=new URLSearchParams(window.location.search);if(!e){r("/login");return}p.get("route")?r(p.get("route")||"/"):r("/")}},[e,s]);let i=(0,o.useMemo)(()=>"Settings",[l]),f=()=>{if(a.current)return;let p=window.location.hash,x=5e3,M=setInterval(()=>{let S=document.getElementById(p.replace("#",""));S&&(clearInterval(M),setTimeout(()=>{let T=S==null?void 0:S.getBoundingClientRect(),G=window.pageYOffset||document.documentElement.scrollTop;if(T&&T.top>0&&!a.current){a.current=!0;let O=T.top+G-104;window.scrollTo({top:O,behavior:"smooth"});return}},500))},100);setTimeout(()=>{M&&clearTimeout(M)},x)};return(0,o.useLayoutEffect)(()=>{f()}),o.default.createElement(g,{sx:{height:"100vh",bgcolor:p=>p.palette.mode==="dark"?"#202124":"#fff"}},o.default.createElement(st,{maxSnack:3},o.default.createElement(vt.Provider,{value:{route:l,setRoute:r}},o.default.createElement(y,{sx:{width:"100%",position:"fixed",zIndex:1100,top:0,height:72,borderBottom:"1px solid",borderColor:"customColor.borderColor",bgcolor:p=>p.palette.mode==="dark"?"#202124":"#fff"}},o.default.createElement(B,{maxWidth:"lg",sx:{p:0}},o.default.createElement(g,{direction:"row",alignItems:"center",justifyContent:"space-between",height:"71px"},o.default.createElement(Z,{href:k,target:"_blank",underline:"none"},o.default.createElement(g,{direction:"row",alignItems:"center",spacing:1},o.default.createElement(y,{component:"span",sx:{cursor:"pointer"},onClick:()=>{e&&r("/")}},o.default.createElement(tt,{sx:{fontSize:32}})),o.default.createElement(w,{fontSize:24,fontWeight:700,sx:{cursor:"pointer"},onClick:()=>{e&&r("/")}},"MaxAI.me"),i&&o.default.createElement(w,{fontSize:24,fontWeight:700},i))),e&&o.default.createElement(kt,null)))),o.default.createElement(B,{maxWidth:"lg",sx:{mt:13}},o.default.createElement(ft,null,o.default.createElement(it,{loading:u},l==="/login"&&o.default.createElement(Xt,null),l==="/"&&o.default.createElement(Zt,null),l==="menu"&&o.default.createElement(Rt,null)))))))},wt=to;var Lt=C(Wt());var A=C(E());var oo=()=>{let s=Y($);return(0,A.useEffect)(()=>{let e=async()=>{let u=await q();s(u)};return window.addEventListener("focus",e),e(),()=>{window.removeEventListener("focus",e)}},[]),A.default.createElement(A.default.Fragment,null,A.default.createElement(gt,null))},Bt=oo;var Ot=document.getElementById("root");if(Ot){let s=(0,Lt.createRoot)(Ot);document.title=K?"Settings | EzMail.AI":"Settings | MaxAI.me",s.render(I.default.createElement(I.default.StrictMode,null,I.default.createElement(V,null,I.default.createElement(j,null,I.default.createElement(Bt,null),I.default.createElement(mt,null),K?I.default.createElement(Pt,null):I.default.createElement(wt,null)))))}
